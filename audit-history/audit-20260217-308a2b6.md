# Audit Report: feat: configurable .claude directory path

**Date:** 2026-02-17
**Commit:** 308a2b6

## Summary

Added a configuration system allowing users to specify the path to their `.claude` directory instead of hardcoding `~/.claude`. Includes a blocking setup screen, validation, and a settings dialog.

## Files Created

| File | Purpose |
|------|---------|
| `server/config.ts` | Config read/write/validate module with `loadConfig`, `saveConfig`, `validateClaudeDir`, `getDirs` |
| `src/hooks/useConfigValidation.ts` | Shared React hook with debounced path validation and save |
| `src/components/SetupScreen.tsx` | Fullscreen blocking setup screen shown when unconfigured |
| `src/components/ConfigDialog.tsx` | Settings dialog for changing the `.claude` path after setup |

## Files Modified

| File | Changes |
|------|---------|
| `server/api-plugin.ts` | Replaced 4 hardcoded directory constants with dynamic `dirs.*` (~42 references). Added guard middleware (503 when unconfigured), 3 config API endpoints |
| `src/App.tsx` | Added config state + loading gate before both mobile/desktop layouts, Settings icon in both headers, ConfigDialog rendering |
| `.gitignore` | Added explicit `config.local.json` entry |

## Also Included (pre-existing changes)

| File | Changes |
|------|---------|
| `src/components/ConversationTimeline.tsx` | Pre-existing modifications |
| `src/components/FileChangesPanel.tsx` | Pre-existing modifications |
| `src/components/StatsPanel.tsx` | Pre-existing modifications |
| `src/lib/parser.ts` | Pre-existing modifications |
| `src/components/TerminalPanel.tsx` | Deleted (replaced by ServerPanel) |
| `src/components/ServerPanel.tsx` | New (pre-existing) |

## Documentation Impact

- No existing documentation files to update (no README.md)
- Config storage is at `config.local.json` in project root, gitignored
- API surface extended with 3 new endpoints documented in code

## Verification

- `bun run lint`: 0 errors (12 pre-existing warnings)
- `bunx tsc -b`: Clean
- `bun run build`: Passes
- Code review: Config gate moved above mobile layout per review feedback
